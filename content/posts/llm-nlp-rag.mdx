---
title: 7 åˆ†é˜å¿«é€Ÿç†è§£ LLMã€NLP èˆ‡ RAGï¼šå¾åŸºç¤æ¦‚å¿µåˆ°å¯¦ä½œç¯„ä¾‹
description: ç”¨ 7 åˆ†é˜å¿«é€Ÿäº†è§£ LLM (å¤§å‹èªè¨€æ¨¡å‹)ã€NLP (è‡ªç„¶èªè¨€è™•ç†) èˆ‡ RAG (æª¢ç´¢å¢å¼·ç”Ÿæˆ)ï¼Œä¸¦é™„ä¸Š Python + Ollama + ChromaDB çš„ RAG ç¯„ä¾‹ç¨‹å¼ï¼Œå¸¶ä½ ç†è§£å¦‚ä½•é€é Embeddings èˆ‡å‘é‡è³‡æ–™åº«å„ªåŒ– AI å›æ‡‰ã€‚
date: 2024-08-07 08:00:00 +0800
tags: [AI, ML, NLP, LLM, RAG, Embeddings, å‘é‡è³‡æ–™åº«, è‡ªç„¶èªè¨€è™•ç†, å¤§å‹èªè¨€æ¨¡å‹, RetrievalAugmentedGeneration]
---

## Retrieval Augmented Generation (RAG)

**æª¢ç´¢å¢å¼·ç”Ÿæˆ (RAG)** æ˜¯è¿‘å¹´ä¾† AI é ˜åŸŸçš„é‡è¦æŠ€è¡“ä¹‹ä¸€ã€‚  
æ–‡ç« é›£æ˜“åº¦ï¼šâ˜…â˜…â˜†â˜†â˜†

ğŸŒŸ æœ¬æ–‡å°‡å¸¶ä½ èªè­˜ï¼š  
- ä»€éº¼æ˜¯ **RAG** åŠå…¶æ‡‰ç”¨å ´æ™¯  
- **LLM (å¤§å‹èªè¨€æ¨¡å‹)** çš„åŸºæœ¬é‹ä½œåŸç†  
- **NLP (è‡ªç„¶èªè¨€è™•ç†)** çš„æ ¸å¿ƒæ¦‚å¿µ  
- Python + Ollama + ChromaDB çš„ **å¯¦ä½œç¯„ä¾‹**  

![AI x ML x NLP](../assets/post/ai/AI%20x%20ML%20x%20NLP.png)  
ä¾†æºï¼š[inwedo - ML,NLP,LLM, and Deep Learning Explained Exploring the Business Potential of AI](https://inwedo.com/blog/business-potential-of-ai-solutions/)

---

## â“ What is LLM (å¤§å‹èªè¨€æ¨¡å‹)

âœ… **LLM = ä¸€å€‹æ–‡å­—æ¥é¾çš„ç”Ÿæˆå¼æ¨¡å‹**  
- æ¯å€‹å›æ‡‰å­—å…ƒçš„ç”¢ç”Ÿï¼Œéƒ½æ˜¯é€éæ©Ÿç‡é‹ç®—æ±ºå®šçš„ã€‚  
- ä¾‹å¦‚ã€Œå°ç£ã€çš„ç”Ÿæˆéç¨‹ï¼Œæ¨¡å‹æœƒå…ˆç®—å‡ºã€Œå°ã€çš„æ©Ÿç‡æœ€é«˜ï¼Œå†æ¥çºŒã€Œç£ã€ã€‚  

### ç¯„ä¾‹ï¼šLLM æ–‡å­—ç”Ÿæˆéç¨‹

| ç¬¬ä¸€å€‹å­—ç”Ÿæˆ | æ©Ÿç‡é¸æ“‡          |
| ------------ | ------------------ |
| æˆ‘ï¼š 10%     |                    |
| å°ï¼š 80%     | âœ…                 |
| ç£ï¼š 15%     |                    |
| ...          |                    |
| æ˜¯ï¼š 55%     |                    |
| ç‰ï¼š 45%     |                    |
| å±±ï¼š 25%     |                    |

ğŸ‘‰ LLM ç”Ÿæˆï¼šå°  

| ç¬¬äºŒå€‹å­—ç”Ÿæˆ | æ©Ÿç‡é¸æ“‡          |
| ------------ | ------------------ |
| æˆ‘ï¼š 10%     |                    |
| å°ï¼š 25%     |                    |
| ç£ï¼š 70%     | âœ…                 |
| ...          |                    |
| æ˜¯ï¼š 30%     |                    |
| ç‰ï¼š 45%     |                    |
| å±±ï¼š 35%     |                    |

ğŸ‘‰ LLM ç”Ÿæˆï¼šå°ç£  

âœ… **LLM çš„é™åˆ¶**  
- å¯èƒ½ç”¢ç”Ÿã€Œå¹»è¦ºã€(hallucination)ã€‚  
- æ²’æœ‰ã€ŒèªçŸ¥é‚Šç•Œã€ï¼Œä¹Ÿå°±æ˜¯ä¸çŸ¥é“è‡ªå·±ä¸çŸ¥é“ä»€éº¼ã€‚  

---

## â“ What is NLP (è‡ªç„¶èªè¨€è™•ç†)

âœ… **NLP (Natural Language Processing)**  
- é€é ML è¨“ç·´æ¨¡å‹è™•ç†è‡ªç„¶èªè¨€ã€‚  
- NLP çš„è¨“ç·´çµæœæ¯” ML æ•´é«”æ¨¡å‹æ›´å®¹æ˜“æ§åˆ¶ã€‚  

---

## â“ What is RAG (æª¢ç´¢å¢å¼·ç”Ÿæˆ)

âœ… **RAG = LLM çš„å¤–æ›çŸ¥è­˜ç³»çµ±**  
- è®“ LLM èƒ½å¤ ã€Œè®€å–å¤–éƒ¨è³‡æ–™åº«ã€ï¼Œå›ç­”è¶…å‡ºåŸæœ¬è¨“ç·´çŸ¥è­˜ç¯„åœçš„å•é¡Œã€‚  
- è¨“ç·´æˆæœ¬ä½ï¼Œå¯éˆæ´»æ•´åˆæ—¢æœ‰çŸ¥è­˜ã€‚  

![Basic RAG Structure](../assets/post/ai/Basic%20RAG%20Structure.png)

âœ… **æ ¸å¿ƒæ¦‚å¿µ**  
1. **è³‡æ–™å¤–æ› (Embeddings)**ï¼šå°‡æ–‡ä»¶è½‰ç‚ºå‘é‡å„²å­˜æ–¼è³‡æ–™åº«ã€‚  
2. **æª¢ç´¢èˆ‡ç”Ÿæˆ**ï¼šQuery â†’ Embedding â†’ ç›¸ä¼¼åº¦æª¢ç´¢ â†’ Prompt â†’ å›ç­”ã€‚  

---

## ğŸŒŸ RAG Demo (Ollama + ChromaDB)

ğŸ‘‰ **æ–‡ä»¶ Embedding ä¸¦å„²å­˜åˆ° ChromaDB**  
```python
import ollama
import chromadb

documents = [
  "Llamas are members of the camelid family meaning they're pretty closely related to vicuÃ±as and camels",
  "Llamas were first domesticated and used as pack animals 4,000 to 5,000 years ago in the Peruvian highlands",
  "Llamas can grow as much as 6 feet tall though the average llama between 5 feet 6 inches and 5 feet 9 inches tall",
  "Llamas weigh between 280 and 450 pounds and can carry 25 to 30 percent of their body weight",
  "Llamas are vegetarians and have very efficient digestive systems",
  "Llamas live to be about 20 years old, though some only live for 15 years and others live to be 30 years old",
]

client = chromadb.Client()

# collection exits ? use it || create one
try:
    collection = client.create_collection(name="docs")
except Exception as e:
    if "Collection docs already exists" in str(e):
        collection = client.get_collection(name="docs")
    else:
        raise e

# ID check
existing_docs = collection.get()
existing_ids = set(existing_docs['ids'])

# Document vectorize and store into vector database
for i, d in enumerate(documents):
    if str(i) in existing_ids:
        print(f"ID {i} already exists, skipping.")
        continue

    response = ollama.embeddings(model="mxbai-embed-large", prompt=d)
    embedding = response["embedding"]
    collection.add(
        ids=[str(i)],
        embeddings=[embedding],
        documents=[d]
    )
```

ğŸ‘‰ å°‡ Query Embedding å¾Œï¼Œåˆ°è³‡æ–™åº«æ‰¾åˆ°æœ€ç›¸ä¼¼çš„è³‡æ–™(data)

```python
Query = "What animals are llamas related to?"

# vectorize and embeddings
response = ollama.embeddings(
  prompt=Query,
  model="mxbai-embed-large"
)
results = collection.query(
  query_embeddings=[response["embedding"]],
  n_results=1
)
data = results['documents'][0][0]
```

ğŸ‘‰ å°‡ Query + data æ•´åˆæˆä¸€å€‹ Prompt è®“ LLM é‡å°é€™å€‹ Prompt ç”¢ç”Ÿå›æ‡‰ ğŸ‘‰output['response']

```python
ollama.pull(model="llama2")
# response
output = ollama.generate(
  model="llama2",
  prompt=f"Using this data: {data}. Respond to this prompt: {Query}"
)

print(output['response'])
```
ğŸ‘‰ å›æ‡‰ç¯„ä¾‹
```
Llamas are members of the camelid family, which means they are closely related to other animals such as:

1. VicuÃ±as: VicuÃ±as are small, wild relatives of llamas and alpacas. They are native to South America and are known for their soft, woolly coats.
2. Camels: As the name suggests, camels are also members of the camelid family. They are known for their large size, long eyelashes, and ability to survive in hot, dry environments.
3. Alpacas: Alpacas are domesticated animals that are closely related to llamas and vicuÃ±as. They are native to South America and are known for their soft, luxurious fibers.

So, to summarize, llamas are related to vicuÃ±as, camels, and alpacas. These animals share similar physical and behavioral characteristics due to their shared evolutionary history within the camelid family.
```

---
å»¶ä¼¸é–±è®€ï¼š
- [RAG Optimize: Data-Chunk](https://hackmd.io/xOaOwrINQL6f7I5MTsPbgQ)

é—œéµå­— : AI, ML, NLP, RAG, Embeddings
